# Plot the results
import matplotlib.pyplot as plt
import numpy as np

our = \
    [0.13850415512465375, 0.13850415512465375, 0.16897506925207753, 0.13019390581717452, 0.1191135734072022, 0.0886426592797784, 0.12188365650969528, 0.12188365650969528, 0.08310249307479224,
     0.10710987996306558, 0.09418282548476455, 0.07202216066481996, 0.06555863342566944, 0.07202216066481994, 0.060941828254847646, 0.054478301015697145, 0.05263157894736842, 0.05124653739612189,
     0.04755309325946445, 0.04339796860572484, 0.03924284395198522, 0.037396121883656507, 0.038781163434903045, 0.03324099722991689, 0.03601108033240997, 0.04339796860572484, 0.0397045244690674,
     0.03462603878116344, 0.03139427516158818, 0.03139427516158819, 0.02770083102493075, 0.026777469990766394, 0.02862419205909511, 0.024469067405355493, 0.02077562326869806, 0.023084025854108958,
     0.02585410895660203, 0.02770083102493075, 0.030009233610341645, 0.030470914127423827, 0.030009233610341645, 0.030932594644506, 0.030470914127423827, 0.03047091412742382, 0.029085872576177285,
     0.030470914127423827, 0.028162511542012932, 0.024469067405355496, 0.023084025854108958, 0.023084025854108958, 0.024007386888273318, 0.024007386888273318, ]

# [0.5, 0.3888, 0.184, 0.1716, 0.1904, 0.1528, 0.1204, 0.0968, 0.104, 0.1168, 0.1004, 0.0884, 0.0744, 0.0564, 0.0656, 0.0588, 0.064, 0.0636, 0.06, 0.0556, 0.0472, 0.0336, 0.04, 0.0348, 0.03, 0.026, 0.0316, 0.0332, 0.026, 0.036, 0.0292, 0.0276, 0.0296, 0.0316, 0.03, 0.0268, 0.0296, 0.0304, 0.0324, 0.0308, 0.0344, 0.032, 0.0336, 0.028, 0.0328, 0.0312, 0.0312, 0.0296, 0.02, 0.0176, 0.02]
base = [ 0.13573407202216067,0.2123730378578024,0.2820867959372115,0.2830101569713758,0.24422899353647276,0.20914127423822715,0.1851338873499538,0.180517082179132,0.14450600184672205,0.1306555863342567,0.13850415512465372,0.11726685133887349,0.10895660203139428,0.09141274238227147,0.07156048014773776,0.08125577100646354,0.07109879963065559,0.07202216066481994,0.06325023084025855,0.06555863342566944,0.05493998153277931,0.06694367497691599,0.05170821791320406,0.05678670360110804,0.05124653739612189,0.04570637119113574,0.05493998153277932,0.04986149584487535,0.0554016620498615,0.04847645429362881,0.05124653739612189,0.0507848568790397,0.04755309325946445,0.043859649122807015,0.04801477377654662,0.042012927054478295,0.044783010156971385,0.04432132963988921,0.046168051708217916,0.04339796860572484,0.05216989843028624,0.037857802400738695,0.03831948291782087,0.03739612188365651,0.042012927054478295,0.04524469067405356,0.042012927054478295,0.03508771929824561,0.03693444136657433,0.034164358264081256,0.03277931671283472, ]
svc = [ 0.13850415512465375,0.36472760849492153,0.21791320406278855,0.1911357340720222,0.1745152354570637,0.12650046168051707,0.141735918744229,0.11772853185595566,0.11542012927054479,0.10526315789473685,0.07109879963065559,0.06555863342566944,0.06555863342566944,0.08541089566020314,0.09787626962142199,0.09372114496768237,0.10018467220683287,0.07756232686980609,0.0886426592797784,0.06740535549399816,0.05493998153277932,0.060480147737765465,0.05909510618651893,0.08125577100646353,0.06371191135734071,0.06278855032317636,0.0507848568790397,0.041089566020313946,0.0443213296398892,0.042474607571560484,0.042936288088642666,0.03693444136657433,0.04155124653739612,0.04201292705447831,0.045706371191135735,0.048938134810710986,0.04478301015697137,0.05401662049861496,0.047091412742382266,0.048014773776546636,0.04709141274238227,0.052631578947368425,0.040627885503231764,0.04709141274238227,0.042474607571560484,0.0443213296398892,0.045706371191135735,0.042474607571560484,0.047091412742382266,0.04108956602031394,0.04524469067405356, ]

accs = [our, base, svc]
label = ["Ours", "GPR", "SVC"]

plt.figure(figsize=(5, 4))
plt.subplots_adjust(left=0.17, bottom=0.15)
for i, (a, l) in enumerate(zip(accs, label)):
    plt.plot(a, label=l)

plt.legend(fontsize=12)
plt.ylim([0, 0.2])
plt.yticks(np.linspace(0., 0.2, 5), fontsize=12)

plt.ylabel("Fractional error", fontsize=12)
plt.xlabel("Number of steps", fontsize=12)
plt.xticks(np.linspace(0, 50, 6), fontsize=12)
plt.tight_layout()
plt.show()

# Quad PD

# our = \
#     [0.5595567867036011, 0.3767313019390582, 0.32409972299168976, 0.32132963988919666, 0.25761772853185594, 0.17174515235457063, 0.1523545706371191, 0.12188365650969529, 0.19667590027700832, 0.24653739612188366, 0.1745152354570637, 0.13573407202216067, 0.15512465373961218, 0.18005540166204986, 0.1329639889196676, 0.0997229916897507, 0.13850415512465375, 0.12188365650969529, 0.10803324099722991, 0.1329639889196676, 0.10526315789473684, 0.11634349030470914, 0.13573407202216067, 0.12465373961218837, 0.14127423822714683, 0.12742382271468145, 0.11080332409972299, 0.12465373961218837, 0.11357340720221606, 0.10526315789473684, 0.08587257617728532, 0.07479224376731301, 0.06371191135734072, 0.060941828254847646, 0.060941828254847646, 0.05817174515235457, 0.06371191135734072, 0.05817174515235457, 0.05817174515235457, 0.038781163434903045, 0.05817174515235457, 0.04709141274238227, 0.05817174515235457, 0.038781163434903045, 0.027700831024930747, 0.027700831024930747, 0.030470914127423823, 0.027700831024930747, 0.030470914127423823, 0.036011080332409975, 0.0443213296398892, 0.036011080332409975, 0.0332409972299169, 0.0221606648199446, 0.0221606648199446, 0.0221606648199446, 0.0110803324099723, 0.013850415512465374, 0.0110803324099723, 0.0110803324099723, 0.01662049861495845, 0.0221606648199446, 0.013850415512465374, 0.0110803324099723, 0.008310249307479225, 0.00554016620498615, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.00554016620498615, 0.00554016620498615, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.0, 0.002770083102493075, 0.0, 0.002770083102493075, 0.0, 0.002770083102493075, 0.002770083102493075, 0.00554016620498615, 0.00554016620498615, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.002770083102493075, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# svc = \
#        [0.7506925207756233, 0.3684210526315789, 0.47368421052631576, 0.3545706371191136, 0.40443213296398894, 0.3601108033240997, 0.3684210526315789, 0.29085872576177285, 0.28254847645429365, 0.25761772853185594, 0.21606648199445982, 0.24376731301939059, 0.16066481994459833, 0.16066481994459833, 0.13850415512465375, 0.17174515235457063, 0.13850415512465375, 0.13019390581717452, 0.0664819944598338, 0.0997229916897507, 0.0664819944598338, 0.07756232686980609, 0.11357340720221606, 0.11357340720221606, 0.11634349030470914, 0.10526315789473684, 0.11357340720221606, 0.12465373961218837, 0.09418282548476455, 0.11911357340720222, 0.10249307479224377, 0.09418282548476455, 0.11357340720221606, 0.13573407202216067, 0.11080332409972299, 0.0997229916897507, 0.10526315789473684, 0.10803324099722991, 0.0997229916897507, 0.10803324099722991, 0.13573407202216067, 0.10526315789473684, 0.09141274238227147, 0.0997229916897507, 0.10803324099722991, 0.11911357340720222, 0.11357340720221606, 0.13850415512465375, 0.12465373961218837, 0.09695290858725762, 0.08587257617728532, 0.10526315789473684, 0.09695290858725762, 0.09695290858725762, 0.0886426592797784, 0.06925207756232687, 0.10249307479224377, 0.09418282548476455, 0.0997229916897507, 0.09141274238227147, 0.06925207756232687, 0.055401662049861494, 0.060941828254847646, 0.055401662049861494, 0.06925207756232687, 0.08033240997229917, 0.09695290858725762, 0.11357340720221606, 0.0997229916897507, 0.09141274238227147, 0.08033240997229917, 0.08587257617728532, 0.08587257617728532, 0.05817174515235457, 0.05817174515235457, 0.060941828254847646, 0.04986149584487535, 0.08033240997229917, 0.0664819944598338, 0.07479224376731301, 0.09141274238227147, 0.10803324099722991, 0.0886426592797784, 0.07202216066481995, 0.09141274238227147, 0.0886426592797784, 0.09141274238227147, 0.07202216066481995, 0.07756232686980609, 0.07202216066481995, 0.07756232686980609, 0.07202216066481995, 0.04986149584487535, 0.04155124653739612, 0.060941828254847646, 0.060941828254847646, 0.06925207756232687, 0.06371191135734072, 0.08033240997229917, 0.06371191135734072, 0.06925207756232687]
# accs = [our, svc]
# label = ["Ours", "SVC"]
#
# print(len(our))
# print(our[80], svc[80])
#
# plt.figure(figsize=(5, 4))
# plt.subplots_adjust(left=0.17, bottom=0.15)
# for i, (a, l) in enumerate(zip(accs, label)):
#     plt.plot(a, label=l)
#
# plt.legend(fontsize=12)
# plt.ylim([0, 0.2])
# plt.yticks(np.linspace(0., 0.2, 5), fontsize=12)
#
# plt.ylabel("Fractional error", fontsize=12)
# plt.xlabel("Number of steps", fontsize=12)
# plt.xticks(np.linspace(0, 100, 6), fontsize=12)
# plt.tight_layout()
# plt.show()